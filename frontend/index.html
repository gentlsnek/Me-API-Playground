<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Me-API Frontend</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background: #f8f9fa;
      color: #333;
    }
    h1, h2 {
      color: #222;
    }
    .card {
      background: #fff;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 0.5rem;
      margin: 0.2rem 0;
    }
    button {
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>My Portfolio</h1>

  <!-- Profile Section -->
  <section class="card">
    <h2>Profile</h2>
    <div id="profile"></div>
    <button onclick="loadProfile()">Load Profile</button>
    <h2>Update Profile</h2>

  <label for="category">Field to update:</label>
  <select id="category">
    <option value="name">Name</option>
    <option value="email">Email</option>
    <option value="github">GitHub</option>
    <option value="linkedin">LinkedIn</option>
  </select>

  <label for="subject">New value:</label>
  <input type="text" id="subject" placeholder="Enter new value">

  <button onclick="updateProfile()">Update Profile</button>

  <p id="response"></p>
  </section>

 

  <!-- Skill Search Section -->
  <section class="card">
    <h2>Search Projects by Skill</h2>
    <input type="text" id="skillInput" placeholder="Enter a skill (e.g., Python)">
    <button onclick="searchProjects()">Search</button>
    <div id="projects"></div>
  </section>

  <!-- All Projects Section -->
  <section class="card">
    <h2>All Projects</h2>
    <button onclick="loadProjects()">Load Projects</button>
    <div id="allProjects"></div>
  </section>

   <section class="card">
  <h2>All Skills</h2>
  <button onclick="loadSkills()">Load all skills</button>
  <button onclick="loadTopSkills()">Load Top Skills</button>
  <div id="allSkills"></div>
</section>



  <script>
    const API_BASE = "https://me-api-playground-backend-df3c.onrender.com"; // change to your hosted API base URL

    async function loadProfile() {
      try {
        const res = await fetch(`${API_BASE}/profile`);
        
        const data = await res.json();
        console.log(data)
        document.getElementById("profile").innerHTML = `
          <p><strong>Name:</strong> ${data.name}</p>
          <p><strong>Email:</strong> ${data.email}</p>
          <p><strong>Github:</strong> <a href=${data.github}>${data.github}</a></p>
          <p><strong>Linkedin:</strong> <a href=${data.linkedin}>${data.linkedin}</a></p>
        `;
      } catch (err) {
        console.error(err);
      }
    }

    async function loadProjects() {
      try {
        const res = await fetch(`${API_BASE}/projects/get`);
        const data = await res.json();
        document.getElementById("allProjects").innerHTML =
          data.map(p => `<p><strong>${p.name}</strong>: ${p.description}</p><a href=${p.github_link}>${p.github_link}</a></p>`).join("");
      } catch (err) {
        console.error(err);
      }
    }

    async function searchProjects() {
      const skill = document.getElementById("skillInput").value;
      try {
        const res = await fetch(`${API_BASE}/projects/byskills/get/${encodeURIComponent(skill)}`);
        const data = await res.json();
        document.getElementById("projects").innerHTML =
          data.length > 0 
            ? data.map(p => `<p><strong>${p.name}</strong>: ${p.description}, <a href=${p.github_link}>${p.github_link}</a></p>`).join("")
            : "<p>No projects found for this skill.</p>";
      } catch (err) {
        console.error(err);
      }
    }

    async function loadSkills() {
    try {
      const res = await fetch(`${API_BASE}/skills`);
      const data = await res.json();

      const container = document.getElementById("allSkills");
      container.innerHTML = "<h3>All Skills</h3>";

      if (data.length === 0) {
        container.innerHTML += "<p>No skills found.</p>";
        return;
      }

      const ul = document.createElement("ul");
      data.forEach(skillObj => {
        const li = document.createElement("li");
        li.textContent = skillObj.skill; // expects { skill: "Python" }
        ul.appendChild(li);
      });

      container.appendChild(ul);
    } catch (err) {
      console.error("Error loading skills:", err);
    }
  }

  // Load top 5 skills
  async function loadTopSkills() {
    try {
      const res = await fetch(`${API_BASE}/skills/top`);
      const data = await res.json();

      const container = document.getElementById("allSkills");
      container.innerHTML = "<h3>Top 5 Skills</h3>";

      if (data.length === 0) {
        container.innerHTML += "<p>No top skills found.</p>";
        return;
      }

      const ul = document.createElement("ul");
      data.forEach(skillObj => {
        const li = document.createElement("li");
        li.textContent = `${skillObj.skill}`;
        ul.appendChild(li);
      });

      container.appendChild(ul);
    } catch (err) {
      console.error("Error loading top skills:", err);
    }
  }

  async function updateProfile() {
  const category = document.getElementById('category').value;
  const subject = document.getElementById('subject').value;
  
  try {
    const response = await fetch(`${API_BASE}/profile/update?category=${encodeURIComponent(category)}&subject=${encodeURIComponent(subject)}`, {
      method: 'GET'
    });
    const data = await response.json();
    document.getElementById('response').innerText = data.message || data.error;
  } catch (err) {
    console.error(err);
    document.getElementById('response').innerText = 'An error occurred';
  }
}
  </script>

</body>
</html>
